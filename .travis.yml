language: python

os:
  - linux

python:
  - "3.6"
  - "3.7"
  - "3.8"
  - "3.9-dev"
  - "nightly"

addons:
  apt:
    packages:
      - direnv

before_install:
  - if [ $TRAVIS_OS_NAME = linux ]; then sudo apt-get install direnv                        ; fi
  - if [ $TRAVIS_OS_NAME = linux ]; then echo 'eval "$(direnv hook bash)"' > ~/.bashrc      ; fi

install:
  - direnv allow
  - make requirements
  - pip install codecov

script:
  - coverage run -m pytest
  - coverage xml

after_success:
  - codecov
